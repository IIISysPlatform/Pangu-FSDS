# Pangu-FSDS:Pangu Fast–Slow think for Dynamic Scheduling
[中文](README.md) | English

## 1. Introduction
With the continuous advancement of intelligent manufacturing, job shop scheduling is increasingly confronted with dynamic decision-making challenges. In the presence of uncertain events such as task insertion, order cancellation, and equipment maintenance, traditional scheduling methods often suffer from slow response times and limited interpretability. The “fast thinking–slow thinking” mechanism of the Pangu large model provides a novel solution for dynamic scheduling. Fast thinking is responsible for quickly generating feasible decisions, while slow thinking performs reasoning and explanation over scheduling problems and invokes appropriate scheduling algorithms for optimization, thereby achieving efficient and adaptive scheduling.

This project is based on Ascend AI computing infrastructure and fine-tunes the Pangu Embedded-7B model to construct an intelligent manufacturing scheduling system that integrates fast-thinking and slow-thinking mechanisms. The goal is to realize a prototype intelligent agent for dynamic scheduling in intelligent manufacturing environments.


## 2. Model Architecture

|                               |   openPangu-Embedded-7B-V1.1   |
| :---------------------------: | :----------------: |
|       **Architecture**        |       Dense        |
|     **Parameters (Non-Embedding)**     |         7B         |
|     **Number of Layers**      |         34         |
|     **Hidden Dimension**      |       12800        |
|    **Attention Mechanism**    |     GQA      |
| **Number of Attention Heads** | 32 for Q，8 for KV |
|      **Vocabulary Size**      |        153k        |
|      **Context Length (Natively)**       |        32k         |
|    **Pretraining Tokens**     |        25T         |


## 3. Fine-tune and Deployment

### 3.1 Environment

##### Hardware Requirements

Atlas 800T A2 (64GB), please refer to [[Atlas 800T A2](https://www.hiascend.com/hardware/firmware-drivers/community?product=4&model=26&cann=8.2.RC1.alpha003&driver=Ascend+HDK+25.0.RC1)] for obtaining the driver and firmware installation packages.

#### System Requirements & Dependencies

- System: Linux (OpenEuler ≥ 24.03 recommended)
- CANN==8.1.RC1: [[CANN Install]](https://www.hiascend.com/document/detail/zh/CANNCommunityEdition/82RC1alpha002/softwareinst/instg/instg_0001.html?Mode=PmIns&OS=Ubuntu&Software=cannToolKit)
- python==3.10
- torch==2.1.0
- torch-npu==2.1.0.post12
- transformers==4.53.2
- peft==0.17.1

The above software environment has been verified, and theoretically supports newer versions. For any questions, please submit an issue.

### 3.2 Fine-tune
>Fine-tuning is performed under the LoRA framework. Before running the training, please modify train.py to specify the base model path, dataset path, and LoRA weight output path.
```bash
cd train
python train.py   --use_card_num 8   --batch_size 8    --epochs 5   --lr 5e-5   --grad_acc_steps 4   --lora_r 16   --lora_alpha 32   --lora_dropout 0.1
```

### 3.3 Inference

>Perform inference using the Transformers framework. Before running, please modify infer.py to specify the base model path, the path to the fine-tuned LoRA weights, and the test dataset path.
```bash
cd infer
python infer.py
```

The Pangu-FSDS model operates in slow-thinking mode by default. It can be switched to adaptive fast–slow thinking mode or fast-thinking mode using the following method:
- In the code example infer.py, the definitions of the auto_thinking_prompt and no_thinking_prompt variables demonstrate how to switch to adaptive fast–slow thinking or fast-thinking mode. Specifically, by appending the /auto_think or /no_think tag to the end of the user input, the current interaction can be switched to adaptive fast–slow thinking mode or fast-thinking mode, respectively.

## 4. Model License

Unless otherwise specified by the open-source license stated in specific files, the Pangu-FSDS model is licensed under the OPENPANGU MODEL LICENSE AGREEMENT VERSION 1.0, which is intended to permit usage and promote the further development of artificial intelligence technologies.

## 5. Disclaimer
Due to the inherent technical limitations of the technologies on which Pangu-FSDS (the “Model”) relies, as well as the fact that the content generated by artificial intelligence is automatically produced by Pangu, the Company makes no warranties or guarantees regarding the following:
- Although the Model’s outputs are generated by AI algorithms, there remains the possibility that certain information may be defective, unreasonable, or cause discomfort. The generated content does not represent the Company’s views, positions, or opinions;
- The Company does not guarantee that the Model is 100% accurate, reliable, complete, timely, secure, error-free, uninterrupted, continuously stable, or free from defects or failures;
- The outputs of the Model do not constitute any form of advice or decision-making basis, nor does the Company guarantee the authenticity, completeness, accuracy, timeliness, legality, functionality, or practicality of the generated content. The generated content cannot replace professional advice from experts in industrial, medical, legal, or other specialized fields. All content is provided for reference purposes only and does not represent any attitude, position, or viewpoint of the Company. Users must make independent judgments based on actual circumstances, and the Company assumes no responsibility for any consequences arising therefrom.

